#include "convert.h"

std::string Convert::ConvertBSTRToMBS(const BSTR bstr) {
  int wslen = ::SysStringLen(bstr);
  return "https://" +
         Convert::ConvertWCSToMBS((wchar_t *)bstr,
                         wslen);  //'https' for successfully loading
}

std::string Convert::ConvertWCSToMBS(const wchar_t *pstr,
                                          const long wslen) {
  int len = ::WideCharToMultiByte(CP_ACP, 0, pstr, wslen, NULL, 0, NULL, NULL);

  std::string dblstr(len, '\0');
  len = ::WideCharToMultiByte(CP_ACP, 0, pstr, wslen, &dblstr[0], len, NULL,
                              NULL);

  return dblstr;
}